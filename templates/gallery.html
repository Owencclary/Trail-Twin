{% extends 'base.html' %}

{% block content %}
    <!------------------- Navbar ------------------------->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">

        <!-- Logo -->
        <a class="navbar-brand" href="/gallery">Trail Twin</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

    <!-- Links-->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/gallery"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
            <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
          </svg></a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/chats"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"/>
          </svg> </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/friends"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-people" viewBox="0 0 16 16">
            <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"/>
          </svg></a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/profile"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
          </svg> </a>
        </li>
      
            
            <!------------------- Search Filter ------------------------->
            <li class="nav-item">
              <form action="/filtered_gallery"  class="nav-link active" aria-current="page" method="POST">
                <div class="dropdown">

                  <!-- dropdown button -->
                    <svg class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-sliders2" viewBox="0 0 16 16">
                      <path fill-rule="evenodd" d="M10.5 1a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4H1.5a.5.5 0 0 1 0-1H10V1.5a.5.5 0 0 1 .5-.5M12 3.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m-6.5 2A.5.5 0 0 1 6 6v1.5h8.5a.5.5 0 0 1 0 1H6V10a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5M1 8a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2A.5.5 0 0 1 1 8m9.5 2a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V13H1.5a.5.5 0 0 1 0-1H10v-1.5a.5.5 0 0 1 .5-.5m1.5 2.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"/>
                    </svg>


                  <ul class="dropdown-menu" style="width: 600px;">

                  <!-- Raidus input -->
                  <li class="custom-li">
                    <label for="customRange1" class="form-label">Radius: </label>
                    <input type="range" class="form-range" name="radius" id="customRange1" min="0" max="100" step="1" value="{{ radius }}">
                  </li>

                  <!-- Min age input -->
                  <li class="custom-li">        
                    <label for="customRange1" class="form-label">Minimun Age: </label>
                    <input type="range" class="form-range" name="min_age" id="customRange1" min="0" max="100" step="1" value="{{ min_age }}">      
                  </li>

                  <!-- max age input -->
                  <li class="custom-li">  
                    <label for="customRange1" class="form-label">Maximun Age: </label>
                    <input type="range" class="form-range" name="max_age" id="customRange1" min="0" max="100" step="1" value="{{ max_age }}">
                  </li>

                  <!-- gender input -->
                  <li class="custom-li">
                    <div class="input-group mb-3">
                      <label class="input-group-text" for="inputGroupSelect01">Gender</label>
                      <select class="form-select" name="gender" id="inputGroupSelect01">
                        <option selected>Choose...</option>
                        <option value="male"> Male </option>
                        <option value="female"> Female </option>
                        <option value="other"> Other </option>
                        <option value="all"> All </option>
                      </select>
                    </div>
                  </li>

                  <!-- activity input -->
                  <li class="custom-li">
                    <div class="input-group mb-3">
                      <label class="input-group-text" for="inputGroupSelect01">Activity</label>
                      <select class="form-select" name="activity" id="inputGroupSelect01">
                        <option selected>Choose...</option>
                        <option value="All"> All </option>
                        <option value="Mountain Biking"> Mountain Biking </option>
                        <option value="Skiing"> Skiing </option>
                        <option value=" Backpacking"> Backpacking </option>
                      </select>
                    </div>
                  </li>

                <!-- submit -->
                <li class="custom-li">
                  <button type="submit" class="btn btn-primary">Filter</button>
                </li>

              </ul>
            </div>
          </div> 
        </form> 
        </li>
      </ul>

        <!-- Search bar -->
        <form id="searchBarForm" class="d-flex" role="search" action="/username_search" method="POST">
          <input class="form-control me-2" style="width: 30vh;" type="search" name='username' placeholder="Search" aria-label="Search" required>
          <button class="btn btn-outline-success" type="submit" form="searchBarForm">Search Users</button>
        </form>

      </div>
    </div>
  </nav>


      <!------------------- Gallery of Users ------------------------->
      <div class="gallery-container" style="height: 100vh;">

        <!-- Grid -->
        <div class="container text-center mx-auto">
            <div class="row">

                <!-- Loop through all filtered users  -->
                {% for user in users %}
                <div class="col-lg-3 mb-3">
                    <div class="card square-card" style="width: 100%;">

                        <!-- profile photo -->
                        <div class="square-image-container" style="padding-bottom: 100%; position: relative;">
                            <img src="{{ profile_photos[user.user_id][0] }}" class="card-img-top" alt="..." style="position: absolute; left: 0; width: 100%; height: 100%;">
                        </div>

                        <!-- user info -->
                        <div class="card-body">
                            <h5 class="card-title">{{ user.first_name }} {{ user.last_name }}</h5>
                            <p class="card-text" style="font-size: small;">@{{ user.username }}</p>
                            <p class="card-text">{{ user.bio }}</p>
                        </div>

                        <!-- Users activities list -->
                        <ul class="list-group list-group-flush">
                            {% if user.user_id in activities_dictionary %}
                              {% for activity_name in activities_dictionary[user.user_id] %}
                                <li class="list-group-item">{{ activity_name }}</li>
                              {% endfor %}
                            {% endif %}
                        </ul>

                        <!-- View profile button -->
                        <div class="card-body">
                            <a type="button" class="btn btn-primary" href="/user/{{ user.user_id }}">View Profile</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    
{% endblock %}